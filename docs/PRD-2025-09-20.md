# PRD – 2025-09-20

## Tech-stack Snapshot
- **Frontend**: Next.js 14, React 18, TailwindCSS, shadcn/ui, Framer Motion
- **Backend**: Next.js Route Handlers (Edge), Upstash Redis for shared state
- **Randomness**: Switchboard On-Demand (Solana mainnet)
- **Deployment**: Vercel (custom domain `wheeloffortune.fyi`)
- **Analytics**: `@vercel/analytics`

## Current Data Keys
| Redis Key | Purpose |
|-----------|---------|
| `entrants:list` | Ordered FIFO list of submitted wallets |
| `winners:list`  | History of winners `{ address, round, ts, vrfTx }` |
| `settings:hash` | UI toggles (timerSec, autoSpin, tokenGate, mint) |
| `nextSpinTs`    | Absolute UNIX-ms timestamp for next auto-spin |

## Completed 2025-09-19
1. Ordered entrant storage & waitlist.
2. Global timer synced via `nextSpinTs`; persistent across refresh & browsers.
3. Webhook-driven VRF; wheel animates on winner row, flashes 10 s.
4. Build passes; live deployment.
5. Error-handling hardening for `/api/state` & `/api/winners`.

## Outstanding Issues / TODOs
| ID | Task | Status |
|----|------|--------|
| fix-spin-400 | Investigate `/api/spin` 400 responses | pending |
| dedupe-winner | Ensure winner written only once | pending |
| pause-countdown | Verify timer resumes exactly after flash | pending |
| vrf-production | Final audit of live VRF flow | pending |

## Goals for 2025-09-20
1. **Stabilise Spin Endpoint** – resolve 400 errors, add better client feedback.
2. **Admin Controls** – secure endpoint to reset entrants & winners.
3. **Monitoring Dashboard** – internal page showing live counts & next spin.
4. **UX Polish** – spinning overlay, confetti on win, remove `Amt` column.
5. **Optional** – replace 1 s polling of `nextSpinTs` with SSE.

_Last updated: 2025-09-19_
